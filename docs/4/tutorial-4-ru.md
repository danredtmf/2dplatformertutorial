# 2D –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä

> –ß–∞—Å—Ç—å —á–µ—Ç–≤—ë—Ä—Ç–∞—è

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [1. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –≤—Ä–∞–≥–∞](#1-—Å–æ–∑–¥–∞–Ω–∏–µ-–±–∞–∑–æ–≤–æ–≥–æ-–≤—Ä–∞–≥–∞)
- [2. –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–∞–≥–∞](#2-—Å–æ–∑–¥–∞–Ω–∏–µ-–≤—Ä–∞–≥–∞)
- [3. –ú–æ–Ω–µ—Ç–∞ –≤—Ä–µ–¥–∏—Ç –≤—Ä–∞–≥–∞–º](#3-–º–æ–Ω–µ—Ç–∞-–≤—Ä–µ–¥–∏—Ç-–≤—Ä–∞–≥–∞–º)
- [4. –ó–∞–¥–∞–Ω–∏—è](#4-–∑–∞–¥–∞–Ω–∏—è)

## 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –≤—Ä–∞–≥–∞

–°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é —Å—Ü–µ–Ω—É —Ç–∏–ø–∞ `KinematicBody2D` –∏ –Ω–∞–∑—ã–≤–∞–µ–º –µ–≥–æ `EnemyBase`.

–í–æ –≤–∫–ª–∞–¥–∫–µ `Collision` –≤ –≥—Ä—É–ø–ø–µ `Layer` –≤—ã–±–µ—Ä–µ–º —Å–ª–æ–π `4` (`Enemy`) –∏ –≤—ã–∫–ª—é—á–∏–º —Å–ª–æ–π `1` (`World`). –ì—Ä—É–ø–ø—É `Mask` –æ—Å—Ç–∞–≤–∏–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

–°–æ–∑–¥–∞—ë–º —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤–Ω—É—Ç—Ä–∏ –æ–±—ä–µ–∫—Ç–∞:

- `Collision` (—Ç–∏–ø `CollisionShape2D`; –Ω–µ –æ–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏—è –Ω–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏, –æ—Å—Ç–∞–≤–ª—è–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- `Animation` (—Ç–∏–ø `AnimatedSprite2D`; –æ—Å—Ç–∞–≤–ª—è–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- `AnimationPlayer` (—Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —á—É—Ç—å –Ω–∏–∂–µ)
- `ChaseZone` (—Ç–∏–ø `Area2D`; —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —á—É—Ç—å –Ω–∏–∂–µ)

–£ —É–∑–ª–∞ `AnimationPlayer` —Å–æ–∑–¥–∞—ë–º –∞–Ω–∏–º–∞—Ü–∏—é `death`. –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ - `1` —Å–µ–∫—É–Ω–¥–∞ (–∏–∫–æ–Ω–∫–∞ —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä–∞ –≤ –ª–µ–≤–æ–π —á–∞—Å—Ç–∏ –ø–∞–Ω–µ–ª–∏ `Animation`). –í–æ –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ–π –Ω–∏–∂–Ω–µ–π –ø–∞–Ω–µ–ª–∏ `Animation` –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —É–∑–µ–ª `Animation` –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ (–Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –∫–ª—é—á–∞ –≤–æ–∑–ª–µ —Å–≤–æ–π—Å—Ç–≤–∞) –∑–Ω–∞—á–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞ `Scale` –≤–æ –≤–∫–ª–∞–¥–∫–µ `Transform` –∏ —Å–≤–æ–π—Å—Ç–≤–∞ `Modulate` –≤–æ –≤–∫–ª–∞–¥–∫–µ `Visibility` —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º —Å–æ–∑–¥–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é `RESET`. –í—Ä–µ–º—è –¥–≤—É—Ö —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–≤–µ–Ω `0`.

–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∫–∞—Ä–µ—Ç–∫—É –Ω–∞ –∞–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–æ—Ä–æ–∂–∫–µ –≤ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ `1` –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø–æ –æ–¥–Ω–æ–º—É –∫–ª—é—á—É –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ –∫–∞–∂–¥–æ–π –∏–∑ –¥–≤—É—Ö –¥–æ—Ä–æ–∂–µ–∫ (–ü–ö–ú ‚û°Ô∏è `Insert Key...` –∏–ª–∏ —Å–Ω–æ–≤–∞ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –∫–ª—é—á–∞ —É –Ω—É–∂–Ω–æ–≥–æ —Å–≤–æ–π—Å—Ç–≤–∞). –ó–Ω–∞—á–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –∫–ª—é—á–∞ –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ –∞–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–æ—Ä–æ–∂–∫–µ `scale` —Ä–∞–≤–µ–Ω `(x: 1, y: 0)`. –ó–Ω–∞—á–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –∫–ª—é—á–∞ –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ –∞–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–æ—Ä–æ–∂–∫–µ `modulate` —Ä–∞–≤–µ–Ω `000000` (—á—ë—Ä–Ω—ã–π —Ü–≤–µ—Ç).

–£ —É–∑–ª–∞ `ChaseZone`, –≤–æ –≤–∫–ª–∞–¥–∫–µ `Collision` –≤ –≥—Ä—É–ø–ø–µ `Layer` –≤—ã–∫–ª—é—á–∏–º —Å–ª–æ–π `1` (`World`). –í –≥—Ä—É–ø–ø–µ `Mask` –≤–∫–ª—é—á–∏–º —Å–ª–æ–π `2` (`Player`) –∏ –≤—ã–∫–ª—é—á–∏–º —Å–ª–æ–π `1` (`World`).

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å—Ü–µ–Ω—É –≤ –ø–∞–ø–∫–µ `objects` ‚û°Ô∏è `enemy` ‚û°Ô∏è `base` —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–∞ `enemy_base.tscn`.

–°–æ–∑–¥–∞–¥–∏–º –∫–æ–¥ –¥–ª—è `EnemyBase`:

```gdscript
class_name EnemyBase
extends CharacterBody2D

enum States { IDLE, CHASE, DIE }

var state: States = States.IDLE:
	set(value):
		state = value
		_check_state()
	get:
		return state

@export var health: int
@export var speed: float
@export var has_gravity: bool

var _chase_run: bool
var _player: Player

@onready var _animation: AnimatedSprite2D = $Animation
@onready var _animation_player: AnimationPlayer = $AnimationPlayer

func _ready() -> void:
	state = States.IDLE

func _physics_process(delta: float) -> void:
	if not is_instance_valid(_player):
		_player = get_tree().get_first_node_in_group("Player") as Player
	
	if has_gravity and not is_on_floor():
		velocity += get_gravity() * delta
	
	if _chase_run:
		var player_direction := \
		global_position.direction_to(_player.global_position)
		
		velocity += player_direction.normalized() * speed * delta
	
	# –û—Ç—Ä–∞–∂–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
	if velocity.x < 0.0:
		_animation.flip_h = true
	else:
		_animation.flip_h = false
	
	move_and_slide()

func hit() -> void:
	health -= 1
	
	if health < 1:
		state = States.DIE

func _check_state() -> void:
	match state:
		States.IDLE:
			_chase_run = false
		States.CHASE:
			_chase_run = true
		States.DIE:
			_die()

func _play_death_animation() -> void:
	if not _animation_player.is_playing():
		_animation_player.play("death")

# –ü—Ä–∏–≥–æ–¥–∏—Ç—Å—è –ø–æ–∑–∂–µ, –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å
func _die() -> void:
	pass

# –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å —Å–∏–≥–Ω–∞–ª `body_entered`
# –û—Ç –æ–±—ä–µ–∫—Ç–∞ `ChaseZone`
# –ö —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É –æ–±—ä–µ–∫—Ç—É (`EnemyBase`)
func _on_chase_zone_body_entered(body: Node2D) -> void:
	if body is Player:
		state = States.CHASE
```

> –î–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ –∏ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π ü•≤.

## 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–∞–≥–∞

–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º —Å–∞–º–æ–≥–æ –≤—Ä–∞–≥–∞. –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é —Å—Ü–µ–Ω—É –∏ –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∏–∫–æ–Ω–∫—É —Ü–µ–ø–æ—á–∫–∏ –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –Ω–∞—Ö–æ–¥–∏–º –∏ –≤—ã–±–∏—Ä–∞–µ–º —Å—Ü–µ–Ω—É `enemy_base.tscn`. –ù–∞–∑—ã–≤–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —É–∑–µ–ª `FloatingEnemy`.

> –†—è–¥–æ–º —Å PDF –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–æ–≤—ã–π —Ä–µ—Å—É—Ä—Å –ø–æ –ø—É—Ç–∏ `resources/sprites/enemy-red-light.png`.

–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?

- –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —É–∑–µ–ª `FloatingEnemy`: —É–∫–∞–∂–∏—Ç–µ –≤ —Å–≤–æ–π—Å—Ç–≤–∞—Ö `Health` –∏ `Speed` –∑–Ω–∞—á–µ–Ω–∏—è `1` –∏ `100` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ
- –£–∑–µ–ª `Collision`: –≤ —Å–≤–æ–π—Å—Ç–≤–µ `Shape` —Å–æ–∑–¥–∞–π—Ç–µ `RectangleShape2D` —Å —Ä–∞–∑–º–µ—Ä–æ–º `(x: 64, y: 64)`
- –£–∑–µ–ª `Animation`: –≤—Å–ø–æ–º–Ω–∏—Ç–µ, –∫–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é —Å–ø—Ä–∞–π—Ç–æ–≤, –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ –∫–∞–¥—Ä—ã –∞–Ω–∏–º–∞—Ü–∏–∏ –∏–∑ —Ñ–∞–π–ª–∞ `enemy-red-light.png` –≤ –∞–Ω–∏–º–∞—Ü–∏—é `default`
- –£–∑–µ–ª `ChaseZone`: —Å–æ–∑–¥–∞–π—Ç–µ –¥–æ—á–µ—Ä–Ω–∏–π —É–∑–µ–ª —Ç–∏–ø–∞ `CollisionShape2D` –∏ –≤ —Å–≤–æ–π—Å—Ç–≤–µ `Shape` —Å–æ–∑–¥–∞–π—Ç–µ `RectangleShape2D` —Å —Ä–∞–∑–º–µ—Ä–æ–º `(x: 256, y: 64)`

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å—Ü–µ–Ω—É –≤ –ø–∞–ø–∫–µ `objects` ‚û°Ô∏è `enemy` ‚û°Ô∏è `floating` —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–∞ `floating_enemy.tscn`.

–ù–∞–∂–º–∏—Ç–µ –ü–ö–ú –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —É–∑–µ–ª `FloatingEnemy` –∏ –≤—ã–±–µ—Ä–∏—Ç–µ `Extend Script...` (—Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å–∫—Ä–∏–ø—Ç).

–°–æ–∑–¥–∞–¥–∏–º –∫–æ–¥ –¥–ª—è `FloatingEnemy`:

```gdscript
class_name FloatingEnemy
extends EnemyBase

func _ready() -> void:
	super._ready()
	_animation.play("default")

func _die() -> void:
	_play_death_animation()
	await _animation_player.animation_finished
	
	queue_free()
```

–î–æ–±–∞–≤–∏–º –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—Ä–∞–≥–æ–≤ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å.

## 3. –ú–æ–Ω–µ—Ç–∞ –≤—Ä–µ–¥–∏—Ç –≤—Ä–∞–≥–∞–º

–ó–∞–π–¥—ë–º –Ω–∞ —Å—Ü–µ–Ω—É `Coin` –∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

–í –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ –º—ã –≤–∫–ª—é—á–∞–ª–∏ `Contact Monitor` –≤–æ –≤–∫–ª–∞–¥–∫–µ `Solver` –∏ —É–∫–∞–∑–∞–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ `10` –≤ —Å–≤–æ–π—Å—Ç–≤–µ `Max Contacts Reported`. –¢–µ–ø–µ—Ä—å –Ω–∞–º —ç—Ç–æ –Ω–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –∏ –º–æ–∂–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–∞–∂–∞–≤ –∏–∫–æ–Ω–∫—É —Å–±—Ä–æ—Å–∞ —Ä—è–¥–æ–º —Å–æ —Å–≤–æ–π—Å—Ç–≤–æ–º. –ï—Å–ª–∏ —Ä–∞–Ω—å—à–µ –º—ã –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–ª–∏—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–≥–Ω–∞–ª `body_entered` —É `Coin`, —Ç–æ —Å–µ–π—á–∞—Å –¥–∞–Ω–Ω—ã–π —Å–∏–≥–Ω–∞–ª –±—É–¥–µ—Ç –Ω–µ –Ω—É–∂–µ–Ω –∏ –µ–≥–æ –º–æ–∂–Ω–æ –æ—Ç–≤—è–∑–∞—Ç—å.

–¢–∞–∫–∂–µ —É —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —É–∑–ª–∞ `Coin` –≤–æ –≤–∫–ª–∞–¥–∫–µ `Collision` –≤ –≥—Ä—É–ø–ø–µ `Mask` –≤—ã–∫–ª—é—á–∏–º —Å–ª–æ–π `4` (`Enemy`), –∞ —Å–ª–æ–π `1` (`World`) –æ—Å—Ç–∞–≤–∏–º. –¢–µ–ø–µ—Ä—å –º–æ–Ω–µ—Ç–∞ –±—É–¥–µ—Ç –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –æ—Ç –∫–∞–∫–æ–π-–ª–∏–±–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ —Å–ª–æ—è `1` (`World`), –∞ –≤—Ä–∞–≥–æ–≤ –±—É–¥–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å.

–¢–µ–ø–µ—Ä—å, —á—Ç–æ–±—ã –º–æ–Ω–µ—Ç–∞ –º–æ–≥–ª–∞ –Ω–∞–Ω–æ—Å–∏—Ç—å —É—Ä–æ–Ω –≤—Ä–∞–≥–∞–º, —É —É–∑–ª–∞ `Coin` –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –¥–æ—á–µ—Ä–Ω–∏–π —É–∑–µ–ª —Ç–∏–ø–∞ `ShapeCast2D` –∏ –∏–∑–º–µ–Ω–∏—Ç—å —É –Ω–µ—ë —Å–ª–µ–¥—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:

- `Shape`: —Å–æ–∑–¥–∞—Ç—å `RectangleShape2D` —Å —Ä–∞–∑–º–µ—Ä–æ–º `(x: 64, y: 64)`
- `Target Position`: `(x: 0, y: 0)`
- `Max Results`: `5`
- `Collision Mask`: –≤—ã–∫–ª—é—á–∏—Ç—å —Å–ª–æ–π `1` (`World`) –∏ –≤–∫–ª—é—á–∏—Ç—å —Å–ª–æ–π `4` (`Enemy`)

–ö–æ–¥ `Coin`:

> –ù–æ–≤—ã–µ —Å—Ç—Ä–æ—á–∫–∏ –∫–æ–¥–∞ –±—É–¥—É—Ç –ø–æ–º–µ—á–∞—Ç—å—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º `#!`, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ—á–∫–∏ - `#?`

```gdscript
class_name Coin
extends RigidBody2D

var _last_object: EnemyBase #! –ù–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è

@onready var _animation_player: AnimationPlayer = $AnimationPlayer
@onready var _interactive_area: InteractiveArea = $InteractiveArea
@onready var _shape_cast_2d: ShapeCast2D = $ShapeCast2D #! –ù–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è

func _ready() -> void:
	_animation_player.play("show")
	gravity_scale = 0.0

#! –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é
func _physics_process(_delta: float) -> void:
	if _shape_cast_2d.is_colliding():
		var object := _shape_cast_2d.get_collider(0)
		if object is EnemyBase:
			if object != _last_object:
				_last_object = object
				
				_last_object.hit()
				can_sleep = false
				await _last_object.tree_exited
				can_sleep = true

func get_interactive() -> InteractiveArea:
	return _interactive_area

# –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å —Å–∏–≥–Ω–∞–ª `tree_exited`
# –û—Ç –æ–±—ä–µ–∫—Ç–∞ `InteractiveArea`
# –ö —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É –æ–±—ä–µ–∫—Ç—É (`Coin`)
func _on_interactive_area_tree_exited() -> void:
	queue_free()

# –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å —Å–∏–≥–Ω–∞–ª `animation_finished`
# –û—Ç –æ–±—ä–µ–∫—Ç–∞ `AnimationPlayer`
# –ö —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É –æ–±—ä–µ–∫—Ç—É (`Coin`)
func _on_animation_player_animation_finished(anim_name: StringName) -> void:
	if anim_name == "show":
		gravity_scale = 1.0

#? –£–¥–∞–ª–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `_on_body_entered`
```

–ü–æ–ø—Ä–æ–±—É–µ–º –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ–¥–æ–±—Ä–∞—Ç—å –º–æ–Ω–µ—Ç—É –∏ —á–µ—Ä–µ–∑ —Ä–µ–∂–∏–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –º–æ–Ω–µ—Ç—ã (–Ω–∞–∂–∞—Ç—å –Ω–∞ `Q`) —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –º–æ–Ω–µ—Ç—É –≤ –º–∏—Ä–µ —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∞ —Ç–æ—á–Ω–æ –∫–æ—Å–Ω—É–ª–∞—Å—å –≤—Ä–∞–≥–∞. –í—Ä–∞–≥ –¥–æ–ª–∂–µ–Ω –ø–æ–≥–∏–±–Ω—É—Ç—å.

## 4. –ó–∞–¥–∞–Ω–∏—è

1. –ù–∞–ø–∏—à–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `_draw` (–ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è) —É —É–∑–ª–∞ `EnemyBase`, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ:

- **–ü–æ–ª—É—á–∞—Ç—å –¥–æ—á–µ—Ä–Ω–∏–µ —É–∑–ª—ã `ChaseZone`**:
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `get_children()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –¥–æ—á–µ—Ä–Ω–∏—Ö —É–∑–ª–æ–≤ `ChaseZone`. –ß—Ç–æ–±—ã –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —É–∑–ª—É –≤ –∫–æ–¥–µ –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å `$ChaseZone`.
- **–ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –¥–æ—á–µ—Ä–Ω–∏—Ö —É–∑–ª–æ–≤**:
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—á–µ—Ä–Ω–∏—Ö —É–∑–ª–æ–≤ –±–æ–ª—å—à–µ –Ω—É–ª—è, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.
- **–ü–µ—Ä–µ–±–∏—Ä–∞—Ç—å –¥–æ—á–µ—Ä–Ω–∏–µ —É–∑–ª—ã**:
   - –ü—Ä–æ–π–¥–∏—Ç–µ—Å—å —Ü–∏–∫–ª–æ–º `for` –ø–æ –∫–∞–∂–¥–æ–º—É –¥–æ—á–µ—Ä–Ω–µ–º—É —É–∑–ª—É, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–º `CollisionShape2D`.
- **–ü–æ–ª—É—á–∞—Ç—å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ (Rect2D) –∏–∑ —Å–≤–æ–π—Å—Ç–≤–∞ `Shape` —É–∑–ª–∞ `CollisionShape2D`**:
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `get_rect()` –∏–∑ —Å–≤–æ–π—Å—Ç–≤–∞ `shape` —É–∑–ª–∞ `CollisionShape2D` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞.
- **–ó–∞–¥–∞–≤–∞—Ç—å —Ü–≤–µ—Ç**:
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ü–≤–µ—Ç –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, `Color.ORANGE_RED`.
- **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**:
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∞–ª—å—Ñ–∞-–∫–∞–Ω–∞–ª (–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å) —É —Ü–≤–µ—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, `0.15` —á–µ—Ä–µ–∑ —Å–≤–æ–π—Å—Ç–≤–æ `a`.
- **–†–∏—Å–æ–≤–∞—Ç—å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫**:
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `draw_rect()` –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ (–ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ—É–Ω–∫—Ü–∏–∏ `rect`) —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ —Ü–≤–µ—Ç (–ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ—É–Ω–∫—Ü–∏–∏ `color`) –∏ —Ç–æ–ª—â–∏–Ω–∞ –ª–∏–Ω–∏–∏ (–ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ—É–Ω–∫—Ü–∏–∏ `width`).

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ, –≤—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å, —á—Ç–æ –≤—Ä–∞–≥ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–º–∫–∏.

2. –°–¥–µ–ª–∞–π—Ç–µ —Ç–∞–∫, —á—Ç–æ–±—ã –≤—Ä–∞–≥–∏ –Ω–µ –ø–æ–≥–∏–±–∞–ª–∏, –∫–æ–≥–¥–∞ –º–æ–Ω–µ—Ç–∞ –ø—Ä–æ—Å—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∏–≥—Ä–æ–≤–æ–º –º–∏—Ä–µ, –∞ –Ω–µ –ø–∞–¥–∞–µ—Ç –∏ –Ω–µ –∏–≥—Ä–∞–µ—Ç –∞–Ω–∏–º–∞—Ü–∏–∏ `show`. –†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å—Ü–µ–Ω—É `Coin`.

- **–î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `_can_hit`:**
- **–û–±–Ω–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `_physics_process`:**
   - –î–æ–±–∞–≤—å—Ç–µ —É—Å–ª–æ–≤–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ `_can_hit` –≤ `true`, –µ—Å–ª–∏ –∞–Ω–∏–º–∞—Ü–∏—è –º–æ–Ω–µ—Ç—ã –∏–≥—Ä–∞–µ—Ç –∏–ª–∏ –º–æ–Ω–µ—Ç–∞ –Ω–µ —Å–ø–∏—Ç (—Å–≤–æ–π—Å—Ç–≤–æ `sleeping`).
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `_can_hit` –≤ `false`, –µ—Å–ª–∏ –∞–Ω–∏–º–∞—Ü–∏—è –Ω–µ –∏–≥—Ä–∞–µ—Ç –∏ –º–æ–Ω–µ—Ç–∞ —Å–ø–∏—Ç.
- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ —É—Å–ª–æ–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è:**
   - –î–æ–±–∞–≤—å—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ `and _can_hit` –≤ –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è, —á—Ç–æ–±—ã –º–æ–Ω–µ—Ç–∞ –º–æ–≥–ª–∞ –Ω–∞–Ω–µ—Å—Ç–∏ —É—Ä–æ–Ω —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ `_can_hit` —Ä–∞–≤–Ω–æ `true`.

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ, –º–æ–Ω–µ—Ç–∞ –±—É–¥–µ—Ç –ø–æ—Ä–∞–∂–∞—Ç—å –≤—Ä–∞–≥–æ–≤ —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è —Å–≤–æ–µ–π –∞–Ω–∏–º–∞—Ü–∏–∏ –∏–ª–∏ –∫–æ–≥–¥–∞ —Ñ–∏–∑–∏–∫–∞ –º–æ–Ω–µ—Ç—ã –Ω–µ "—Å–ø–∏—Ç".